# Phase 0 Research - Padel Host App (MVP)

## Decision 1: Backend framework = FastAPI with Pydantic v2
- **Decision**: Use FastAPI for REST endpoints and Pydantic v2 DTOs for request/response validation.
- **Rationale**: Matches requested stack, gives typed contracts, autogenerated OpenAPI, and straightforward dependency injection for services/repositories.
- **Alternatives considered**:
  - Flask + Marshmallow: lighter, but weaker built-in typing/contracts.
  - Django REST Framework: more batteries included, but heavier than needed for MVP.

## Decision 2: Persistence = DuckDB file database + repository pattern
- **Decision**: Use a single DuckDB file (`padel.duckdb`) and isolate SQL in repository classes.
- **Rationale**: Fast local embedded DB, SQL-first workflow, and clear swap path to Postgres later by replacing repository implementations.
- **Alternatives considered**:
  - SQLite: valid for MVP, but user explicitly requested DuckDB.
  - ORM (SQLAlchemy): rejected due to explicit raw SQL requirement.

## Decision 3: Domain structure = layered architecture
- **Decision**: Keep strict layers: `domain` -> `services` -> `repositories` -> `api`.
- **Rationale**: Maximizes testability and portability; business rules remain DB/framework agnostic.
- **Alternatives considered**:
  - Fat-router style with inline SQL: quicker initially, poor long-term maintainability.
  - Service + ORM models only: conflicts with raw SQL requirement.

## Decision 4: Frontend stack = React + TypeScript + Vite + Tailwind + shadcn/ui
- **Decision**: Build host-first SPA with React Router pages: Lobby, Preview, Running, Summary.
- **Rationale**: Requested stack with fast iteration speed and reusable component approach.
- **Alternatives considered**:
  - Next.js: unnecessary SSR complexity for MVP admin tool.
  - Plain CSS/no design system: inconsistent UI and slower feature iteration.

## Decision 5: UI effects integration
- **Decision**: Use LightRays as subtle background layer and MagicBento cards for main mode/workflow navigation; disable star effects.
- **Rationale**: Aligns with requested visual direction while preserving readability for operational event screens.
- **Alternatives considered**:
  - Heavy animated backgrounds everywhere: harms usability during live scoring.
  - No effects: does not satisfy visual requirement.

## Decision 6: Scheduling strategy per mode
- **Decision**:
  - Americano: round-by-round court movement (winners up, losers down, top court stays).
  - Mexicano: rank by round team points, regroup top-4/next-4, prevent same partner as previous round.
  - BeatTheBox: boxes of 4 ordered by global ranking, fixed 3-round partner rotations per box.
- **Rationale**: Direct match with spec rules and deterministic testability.
- **Alternatives considered**:
  - Random rematch generation every round: violates mode rules.
  - Global optimization solver for pairings: overkill for MVP.

## Decision 7: Scoring model
- **Decision**:
  - Americano: store winner/loser outcome per match and event-local round points.
  - Mexicano: store exact team scores (sum=24) and assign each player their team score.
  - BeatTheBox: support win/loss/draw with global ranking deltas (+25/-15/+5).
- **Rationale**: Covers all required result input types and summary reporting.
- **Alternatives considered**:
  - Normalize all modes to winner-only schema: loses Mexicano granularity.

## Decision 8: API design and boundaries
- **Decision**: Versioned REST API under `/api/v1` with resources for players, events, rounds, matches, and summaries.
- **Rationale**: Clean contract for current SPA and future multi-user clients.
- **Alternatives considered**:
  - GraphQL: flexible but unnecessary for MVP complexity.

## Decision 9: Testing approach
- **Decision**: Use pytest with unit tests for scheduling/scoring services and integration tests for repositories + API contracts.
- **Rationale**: Validates critical business rules and persistence integrity.
- **Alternatives considered**:
  - API-only tests: misses core scheduling rule edge cases.

## Decision 10: Constitution clarification
- **Decision**: Treat `.specify/memory/constitution.md` as a template with placeholders (no enforceable project-specific gates yet).
- **Rationale**: File contains unresolved tokens (e.g., `[PRINCIPLE_1_NAME]`), so planning gates rely on explicit user requirements + AGENTS.md coding guidance.
- **Alternatives considered**:
  - Blocking plan execution: rejected to avoid deadlock; documented as governance gap to be filled later.
